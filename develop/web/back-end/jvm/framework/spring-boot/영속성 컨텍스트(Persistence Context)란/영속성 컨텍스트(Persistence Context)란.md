# 영속성 컨텍스트(Persistence Context)란

- 영속성 컨텍스트(Persistence Context)는 JPA에서 **엔티티 객체를 관리하는 일종의 캐시 공간**.
- 데이터베이스에 저장되거나 조회된 엔티티 객체들은 영속성 컨텍스트에서 관리되며, 이 컨텍스트는 애플리케이션과 데이터베이스 간의 중간 역할을 함.
- 엔티티 객체의 상태 변화를 감지하고 데이터베이스와 동기화하는 작업을 수행.
- 특징
    - **엔티티의 생명 주기 관리**:
        - **비영속 (Transient)**: 영속성 컨텍스트와 전혀 관련이 없고, 데이터베이스에도 저장되지 않은 상태.
        - **영속 (Persistent)**: 영속성 컨텍스트에 의해 관리되고 있으며, 데이터베이스와 동기화될 수 있는 상태.
        - **준영속 (Detached)**: 영속성 컨텍스트에서 더 이상 관리되지 않지만, 한때 영속 상태였던 상태.
        - **삭제 (Removed)**: 영속성 컨텍스트에서 제거되고, 데이터베이스에서도 삭제될 상태.
    - **1차 캐시 역할**:
        - 영속성 컨텍스트는 엔티티 객체를 캐싱하여 **같은 엔티티를 반복적으로 데이터베이스에서 조회하지 않음**. 동일한 트랜잭션 내에서 같은 식별자(PK)를 가진 엔티티가 여러 번 조회되면, 실제 데이터베이스에서 데이터를 불러오지 않고, 영속성 컨텍스트에 있는 객체를 반환.
    - **변경 감지 (Dirty Checking)**:
        - 영속성 컨텍스트는 관리하는 엔티티 객체의 상태 변화를 감지함. 트랜잭션이 커밋될 때 변경된 엔티티를 자동으로 데이터베이스에 반영함.
    - **쓰기 지연 (Write-Behind)**:
        - 영속성 컨텍스트는 트랜잭션이 끝날 때까지 변경 내용을 데이터베이스에 바로 반영하지 않고, 메모리에 모았다가 트랜잭션이 커밋되면 한꺼번에 반영하는 방식을 취함.