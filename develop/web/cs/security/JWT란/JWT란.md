# JWT란 무엇이며 어떻게 사용되는가

- JWT(JSON Web Token)는 JSON 형식으로 사용자 인증 및 정보를 안전하게 전송하기 위해 사용되는 토큰이다.
- 클라이언트-서버 간의 신뢰할 수 있는 데이터 교환을 목적으로 설계되었으며, 인증과 데이터 전송을 효과적으로 처리할 수 있다.

---

# **JWT의 구조**

- JWT는 `.`으로 구분된 세 부분으로 구성된다.

## **Header (헤더)**

- 토큰의 메타데이터 정보를 포함하며, 일반적으로 두 가지 정보를 가진다:
- 알고리즘 타입 (예: HS256, RS256)
- 토큰 타입 (JWT)

**예시**

```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

## **Payload (페이로드)**

토큰에 담길 정보(클레임)를 포함. 클레임은 세 가지로 구분된다:

- **등록된 클레임**: 표준화된 키(예: `iss`(발급자), `sub`(주제), `exp`(만료 시간))
- **공개 클레임**: 사용자 정의 키
- **비공개 클레임**: 서버와 클라이언트 간의 정보 교환을 위한 비공개 데이터

**예시**

```json
{
  "sub": "1234567890",
  "name": "John Doe",
  "admin": true
}
```

## **Signature (서명)**

- 토큰의 무결성을 검증하기 위한 부분으로, 헤더와 페이로드를 암호화한 값이다.
- 서명은 비밀 키와 알고리즘을 사용해 생성되며, 이를 통해 토큰이 변조되지 않았음을 확인할 수 있다.

**생성 과정**

```scss
HMACSHA256(
  base64UrlEncode(header) + "." + base64UrlEncode(payload),
  secret
)
```

---

# **JWT의 사용 사례**

## **사용자 인증**

- 서버는 사용자가 인증에 성공하면 JWT를 발급하여 클라이언트에게 반환.
- 클라이언트는 JWT를 HTTP 요청 헤더에 포함해 서버에 요청.
- 서버는 JWT를 검증해 요청의 신뢰성을 판단.

**예시**

- 클라이언트 요청 헤더:

    ```makefile
    Authorization: Bearer <JWT>
    ```


## **정보 교환**

- JWT를 사용해 클라이언트와 서버 간에 중요한 데이터를 안전하게 전송.
- 서명을 통해 데이터가 변조되지 않았음을 보장.

## **분산 시스템**

- JWT는 상태를 저장하지 않는 무상태성 덕분에 분산 시스템에서 효과적으로 사용.

---

# **JWT의 동작 과정**

## **사용자 인증 및 JWT 발급**

- 클라이언트가 로그인 정보를 서버에 전송.
- 서버가 로그인 정보를 확인한 후 JWT를 생성하여 클라이언트에게 반환.

## **클라이언트의 요청**

- 클라이언트는 발급받은 JWT를 HTTP 헤더에 포함해 서버로 요청 전송.

## **서버의 JWT 검증**

- 서버는 JWT의 서명을 확인하고, 페이로드의 정보를 기반으로 요청을 처리.

## **요청 처리 및 응답 반환**

- 서버는 요청을 처리하고 응답을 클라이언트에 반환.

---

# **JWT의 장점**

## **무상태성**

- 서버가 사용자 세션을 저장할 필요가 없으므로, 확장성이 뛰어남.

## **안전성**

- 서명을 통해 토큰의 변조를 방지.

## **유연성**

- 페이로드에 다양한 정보를 포함할 수 있어 여러 용도로 활용 가능.

## **독립성**

- 클라이언트와 서버가 서로 독립적으로 설계 가능.

---

# **JWT의 단점**

## **크기 문제**

- JWT는 헤더, 페이로드, 서명으로 인해 크기가 상대적으로 크며, 네트워크 트래픽에 영향을 줄 수 있음.

## **비밀 키 관리**

- 서명 검증을 위한 비밀 키가 유출되면 보안 문제가 발생.

## **토큰 취소 어려움**

- JWT는 무상태성을 기반으로 하기 때문에, 발급된 토큰을 실시간으로 무효화하는 데 어려움이 있음. (예: 로그아웃 구현 시 어려움)

---

# **JWT의 보안 고려 사항**

## **HTTPS 사용**

- JWT는 민감한 정보를 포함할 수 있으므로, 반드시 HTTPS를 사용해 전송.

## **토큰 만료 시간 설정**

- `exp`(만료 시간) 클레임을 사용해 토큰의 유효 기간을 제한.

## **서버에서 키 보호**

- 서명을 위한 비밀 키 또는 공개/비공개 키를 안전하게 관리.

## **재발급 전략**

- 만료 시간이 짧은 액세스 토큰과 긴 유효 기간의 리프레시 토큰을 함께 사용.

---

# 요약

- JWT는 RESTful API와 같은 무상태 애플리케이션에서 특히 유용하며, 인증 및 정보 교환의 표준으로 자리 잡고 있다.
- 인증과 정보 교환을 위해 사용되는 JSON 기반 토큰으로, 무상태성, 서명을 통한 데이터 무결성 보장, 그리고 유연성이 주요 장점이다.
- HTTP 헤더에 포함해 요청을 처리하며, 보안 강화를 위해 HTTPS, 만료 시간 설정, 키 관리가 필수적이다.