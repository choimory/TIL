# 정규화와 역정규화

- *정규화(Normalization)*와 **역정규화(Denormalization)**는 **데이터베이스 설계**에서 데이터 구조를 최적화하는 두 가지 상반된 기법이다.

---

# **정규화(Normalization)**

## **목적**:

- **데이터 중복을 최소화**하고, **데이터 무결성**을 유지하기 위해 데이터베이스 테이블을 논리적으로 나누는 과정이다.
- 데이터 간의 **종속성을 제거**하여 데이터 일관성을 유지하고, 데이터 수정 시 **이상 현상(Anomalies)**을 방지하는 것이 주된 목표다.

## **방법**:

- 데이터베이스의 스키마를 **여러 테이블로 분리**하여 각 테이블이 고유한 역할을 하도록 설계한다.
- 이를 통해 **중복된 데이터**를 제거하고, 데이터가 수정될 때 모든 테이블에 일관되게 반영될 수 있도록 한다.

## **사용 시기**:

- **데이터 무결성**과 **쓰기 작업**이 중요한 경우, 또는 **중복 데이터를 줄이고** 저장 공간을 절약해야 할 때 사용된다.

## **장점**:

- **데이터 중복 제거**:
    - 데이터를 나누어 저장함으로써 중복을 줄일 수 있다.
- **데이터 무결성 보장**:
    - 데이터가 여러 테이블에 걸쳐 분리되므로, 수정 시 일관성을 유지할 수 있다.
- **저장 공간 절약**:
    - 중복 데이터가 제거되기 때문에 저장 공간을 절약할 수 있다.
- **쓰기 성능 향상**:
    - 데이터 수정 시 중복된 데이터를 일일이 수정할 필요가 없어 효율적이다.

## **단점**:

- **조회 성능 저하**:
    - 데이터를 조회할 때 여러 테이블 간의 **조인(Join)** 연산이 필요해 성능이 저하될 수 있다.
- **복잡한 쿼리**:
    - 정규화된 데이터 구조는 **쿼리가 복잡해질 수** 있다.
    - 여러 테이블을 참조해야 하는 경우가 많아 관리와 사용이 어려워질 수 있다.

## **예시**: 고객 정보와 주문 정보를 각각의 테이블로 분리하여 저장.

```sql
-- 고객 테이블
CREATE TABLE customers (
  customer_id INT PRIMARY KEY,
  name VARCHAR(100),
  email VARCHAR(100)
);

-- 주문 테이블
CREATE TABLE orders (
  order_id INT PRIMARY KEY,
  customer_id INT,
  order_date DATE,
  FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);
```

---

# **역정규화(Denormalization)**

## **목적**:

- **조회 성능을 최적화**하기 위해 데이터베이스 스키마에서 **중복 데이터를 허용**하고, 일부 테이블을 **병합**하거나 **중복 저장**하는 방법이다.
- 이를 통해 조인 없이 빠르게 데이터를 조회할 수 있다.

## **방법**:

- **정규화된 데이터 구조**에서 데이터를 다시 결합하거나 중복 데이터를 추가하여 **데이터 조회를 빠르게** 한다.
- 이는 **읽기 성능 최적화**가 주요 목적이다.

## **사용 시기**:

- **읽기 성능이 중요한 경우**, 특히 **실시간 조회**가 많이 발생하는 애플리케이션에서 사용된다.
- 정규화로 인한 조인 비용이 성능에 부정적 영향을 미치는 경우 유용하다.

## **장점**:

- **조회 성능 향상**:
    - 조인을 줄여 데이터를 더 빠르게 조회할 수 있다.
- **쿼리 간소화**:
    - 데이터를 한 테이블에 중복 저장하면 복잡한 쿼리를 간단하게 만들 수 있다.
- **데이터 접근 시간 단축**:
    - 여러 테이블에 걸친 데이터를 하나의 테이블에서 조회할 수 있으므로 성능이 향상된다.

## **단점**:

- **데이터 중복**:
    - 중복된 데이터로 인해 **저장 공간을 더 많이 차지**하며, 저장 비용이 증가할 수 있다.
- **데이터 무결성 저하**:
    - 중복된 데이터를 유지하려면 **여러 테이블에서 동일한 데이터를 일관되게 관리**해야 하므로, 무결성 유지가 어려워질 수 있다.
- **쓰기 성능 저하**:
    - 중복된 데이터를 수정해야 할 경우, 여러 곳에서 데이터를 동시에 업데이트해야 하므로 **쓰기 성능**이 떨어질 수 있다.

## **예시**: 고객 정보와 주문 정보를 하나의 테이블에 중복 저장하여 성능을 최적화.

```sql
CREATE TABLE orders_with_customers (
  order_id INT PRIMARY KEY,
  customer_id INT,
  customer_name VARCHAR(100), -- 중복된 고객 이름
  order_date DATE
);
```

---

# 비교

| **항목** | **정규화(Normalization)** | **역정규화(Denormalization)** |
| --- | --- | --- |
| **목적** | 데이터 중복을 제거하고 무결성을 유지 | 조회 성능을 향상시키기 위해 중복 데이터를 허용 |
| **데이터 중복** | 중복을 최소화 | 데이터를 중복 저장하여 성능을 최적화 |
| **데이터 무결성** | 데이터 무결성 유지 용이 | 데이터 무결성 유지가 어려울 수 있음 |
| **조회 성능** | 조회 시 여러 테이블 간 조인으로 성능이 저하될 수 있음 | 조인을 줄여 빠른 조회 성능 제공 |
| **쓰기 성능** | 빠른 쓰기 성능 (데이터 중복 없음) | 중복된 데이터 수정 시 쓰기 성능 저하 가능 |
| **사용 사례** | 데이터 일관성과 무결성이 중요한 시스템 | 읽기 성능이 중요한 시스템 (예: 데이터 웨어하우스) |
| **저장 공간** | 저장 공간 효율적 사용 | 저장 공간이 더 필요함 |

---

# 정리

- **정규화**는 **데이터 무결성**과 **쓰기 작업의 효율성**을 높이기 위해 사용되며, 중복 데이터를 제거하여 데이터베이스를 최적화한다.
- 반면, **역정규화**는 **데이터 조회 성능**을 최적화하기 위해 일부 데이터 중복을 허용하며, 주로 **읽기 성능이 중요한 경우**에 사용된다.
- 두 기법은 상반된 목적을 가지므로, 시스템의 특성에 따라 **정규화와 역정규화의 균형**을 맞추는 것이 중요하다.